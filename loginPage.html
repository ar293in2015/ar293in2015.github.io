<!DOCTYPE html>
<html lang="en" ng-app = "app">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
  <title>Wee Expectations</title>
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>

  <!-- CSS  -->
  
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Questrial" />

  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
  <script type="text/javascript" src='https://code.jquery.com/jquery-1.10.2.min.js'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.min.js" type="text/javascript" charset="utf-8"></script>
    <link href='https://fonts.googleapis.com/css?family=Stint+Ultra+Condensed' rel='stylesheet' type='text/css'>
   
  <script type="text/javascript" src="js/userData.js"></script>

<!-- <script type="text/javascript" src="js/main.js"></script> -->
<!-- <script src="MAIN.js"></script> -->
</head>
<body>
<!-- FACEBOOK LOGIN -->
          <div id="fb-root"></div>
            <script>

             window.fbAsyncInit = function() {
              FB.init({
                appId      : '200121150436225',
                xfbml      : true,
                cookies    : true,
                version    : 'v2.8'
              });
              FB.AppEvents.logPageView();
            };



            (function(d, s, id){
               var js, fjs = d.getElementsByTagName(s)[0];
               if (d.getElementById(id)) {return;}
               js = d.createElement(s); js.id = id;
               js.src = "//connect.facebook.net/en_US/sdk.js";
               fjs.parentNode.insertBefore(js, fjs);
             }(document, 'script', 'facebook-jssdk'));
             
               
              (function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8";
                fjs.parentNode.insertBefore(js, fjs);
              }(document, 'script', 'facebook-jssdk'));


            // retrieve user data
            function basicAPIRequest() {
              console.log('api request');
              FB.api('/me', 
                  {fields: "id,about,age_range,picture,context,email,first_name,gender,location,middle_name,name"}, 
                  function(response) {
                    console.log('API response', response);
                    $("#fb-profile-picture").append('<img src="' + response.picture.data.url + '"> ');
                    $("#name").append(response.name);
                    $("#user-id").append(response.id);
                    $("#gender").append(response.gender);
                    $("#email").append(response.email);
                    saveData(response);
                    // $("#education").append(response.hometown);
                  }
              );
            }
            jQuery(document).ready(function(){
              console.log("loading fb data");
              jQuery("#loadData").click(function(e){
                if(typeof(FB) == "undefined") {
                    alert("Facebook SDK not yet loaded please wait.")
                  }
                FB.getLoginStatus(function(response) {
                  if (response.status === 'connected') {
                    console.log('Logged in.');
                    basicAPIRequest();

                  }
                  else {
                    FB.login();
                  }
                });

                 FB.Event.subscribe('auth.login', function(){
                     window.location.href = 'index.html';
                  });

                  FB.Event.subscribe('auth.logout', function(){
                      window.location.href = 'index.html';
                  });

              });

            });
        </script>
        <!-- END OF FACEBOOK LOGIN SCRIPT -->





  <nav style="background-color:#D22A21" role="navigation">
    <div class="nav-wrapper container">
      <a class="white-text" id="logo-container" href="index.html" class="brand-logo">Wee Expectations</a>
      
     
      <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
    </div>
  </nav>

  <div id="index-banner" class="parallax-container">
    <div class="section no-pad-bot">
      <div class="container">
        <br><br>
        <h1 class="header center black-text text-lighten-2">Wee Expectations</h1>
   

        <br><br>

      </div>
    </div>
  </div>


  <div  class="container">
    <div  id = "dashboard" class="section">

      <!--   Icon Section   -->
      <div class="row">
         <div ng-controller='dashboardController'>
            <h2 class="center">Login</h2>

      </div>

        



<!-- <div class="fb-login-button" data-scope="email,user_birthday,user_hometown,user_location" data-max-rows="1" data-size="medium" data-show-faces="false" data-auto-logout-link="false"></div>
 --><div class="fb-login-button" data-scope="email" data-max-rows="1" data-size="medium" data-show-faces="false" data-auto-logout-link="false"></div>

<button id='loadData'>Load data</button>
<!-- fb-profile-picture: --> <div id="fb-profile-picture"></div>
<!-- name: --> <div id="name"></div>
<!-- user-id: --> <div id="user-id"></div>
<div id="gender"></div>
<div id="email"></div>

        <div>
      <!-- END OF FACEBOOK LOGIN -->

      <p><a class="black-text" href="dashboard.html">View Dashboard</a></p>
    </div>

  <!--  Scripts-->

  </body>
</html>
